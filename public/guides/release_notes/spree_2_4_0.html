<!DOCTYPE html>
<!--[if lt IE 7]> <html class="lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>    <html class="lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>    <html class="lt-ie9"> <![endif]-->
<!--[if IE 9]>    <html class="ie9"> <![endif]-->
<!--[if gt IE 9]><!--> <html lang="en" > <!--<![endif]-->
<head>
  <title>Spree 2.4.0 - Release Notes | Spree - Ruby on Rails e-commerce platform</title>

  <meta charset="utf-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>



<meta name="viewport" content="width=device-width, initial-scale=1"/>
<meta name="section" content="version" />

<link href="/favicon.ico" rel="shortcut icon" type="image/x-icon" />

<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<link href="/shared/css/icons.css" media="screen" rel="stylesheet" type="text/css">
<link href="/shared/css/icons-codes.css" media="screen" rel="stylesheet" type="text/css">

<link href="/shared/css/skeleton.css" media="screen" rel="stylesheet" type="text/css">
<link href="/shared/css/documentation.css" media="screen" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="/assets/stylesheets/guides.css" media="screen" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-migrate/1.1.1/jquery-migrate.min.js"></script>
<script src="/assets/javascripts/css_browser_selector_dev.js" type="text/javascript"></script>
<script src="/assets/javascripts/jquery.toc.js" type="text/javascript"></script>
<script src="/assets/javascripts/documentation.js" type="text/javascript"></script>


</head>
<body class="integration">
  
  <header id="header">
    <div id="top-header">
  <div class="container">
    <div class="row">
      <div class="two columns">
  <a class="logo" href="http://spreecommerce.org">
    <img src='/images/logo.png' alt="Spree Commerce - Ruby on Rails e-commerce platform" />
  </a>
</div>

      <div class="three columns">
  <input type="text" id="search-field" placeholder="Search..." />
</div>

      <nav id="main-menu" class="eleven columns">
  <ul class="inline">
    <li><a href="../api/">API</a></li>
    <li><a href="../developer/">Developer</a></li>
    <li><a href="../user/">User</a></li>
    <li><a href="../release_notes/">Release Notes</a></li>
    <li>
      <a href="http://slack.spreecommerce.org" target="_blank">Slack</a>
    </li>
    <li>
      <a href="https://heroku.com/deploy?template=https://github.com/spree/spree" target="_blank" rel="nofollow">Demo</a>
    </li>
  </ul>
</nav>

    </div>
  </div>
</div>


    <div id="subheader">
      <div class="container">
        <div class="twelve columns">
          <h1 class="page-title">Spree 2.4.0 - Release Notes</h1>
        </div>
      </div>
    </div>

  </header>

  <div class="container">
    <section id="main-content">

      <div class="twelve columns">
        <div id="content">
          
<h2 id="majornew-features">Major/new features</h2>

<h3 id="return-authorization-rewrite">Return Authorization Rewrite</h3>

<p>Return Authorizations have received a major rewrite, and can be read more about in the updated <a href="http://guides.spreecommerce.org/user/returning_orders.html">Returning Orders</a> guide.</p>

<p>The previous return authorization code has been extracted into an extension if you would like to continue using it:
<a href="https://github.com/spree-contrib/spree_legacy_return_authorizations">https://github.com/spree-contrib/spree_legacy_return_authorizations</a></p>

<h3 id="html-email-templates">HTML Email Templates</h3>

<p>There are now default HTML email templates, which use <a href="http://zurb.com/ink/templates.php">Zurb Ink</a> and <a href="https://github.com/fphilipe/premailer-rails">Premailer-Rails</a> for responsive styling.</p>

<h3 id="guides-moved-into-core-repository">Guides moved into core repository</h3>

<p>The previous spree-guides repository has been merged into the <a href="https://github.com/spree/spree">Spree Core</a> repository.  Any documentation updates to this website should now be submitted with pull requests to <a href="https://github.com/spree/spree">https://github.com/spree/spree</a></p>

<h2 id="upgrade-tips">Upgrade Tips</h2>

<h3 id="read-the-upgrade-guide">Read the upgrade guide</h3>

<p>For information about upgrading a basic spree store, please read the <a href="http://guides.spreecommerce.org/developer/two-dot-three-to-two-dot-four.html">2.3 to 2.4 upgrade guide</a>.</p>

<h3 id="other-gotchas">Other Gotchas</h3>

<p>If you have implemented your own authentication system instead of using spree_auth_devise,
or you have implemented your own adjustment source please ensure you change your
concerns to the new namespace:</p>

<div class="language-ruby highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre><span class="constant">Spree</span>::<span class="constant">Core</span>::<span class="constant">AdjustmentSource</span> =&gt; <span class="constant">Spree</span>::<span class="constant">AdjustmentSource</span>
<span class="constant">Spree</span>::<span class="constant">Core</span>::<span class="constant">CalculatedAdjustments</span> =&gt; <span class="constant">Spree</span>::<span class="constant">CalculatedAdjustments</span>
<span class="constant">Spree</span>::<span class="constant">Core</span>::<span class="constant">UserAddress</span> =&gt; <span class="constant">Spree</span>::<span class="constant">UserAddress</span>
<span class="constant">Spree</span>::<span class="constant">Core</span>::<span class="constant">UserPaymentSource</span> =&gt; <span class="constant">Spree</span>::<span class="constant">UserPaymentSource</span>

</pre></div>
</div>
</div>

<p>Also please review each of the noteable changes, and ensure your customizations
or extensions are not effected. If you are effected by a change, and have any
of your own tips please submit a PR to help the next person!</p>

<h2 id="full-changelog">Full Changelog</h2>

<p>You can view the full changes using <a href="https://github.com/spree/spree/compare/2-3-stable...2-4-stable">Github Compare</a></p>

<h2 id="noteable-changes">Noteable Changes</h2>
<ul>
  <li>
    <p>The admin order creation/edit process now closely matches the frontend by allowing a separate cart and shipments page.</p>

    <p>Tyler Smart (tesserakt)</p>
  </li>
  <li>
    <p>Add authorize_payments! and capture_payments! to the public interface of orders.</p>

    <p>Richard Wilson</p>
  </li>
  <li>
    <p>Spree no longer holds aws-sdk as a core dependency. In case you use it
you need to add it to your Gemfile. See paperclip README for reference on
scenarios where this is needed https://github.com/thoughtbot/paperclip/tree/v4.1.1#understanding-storage</p>

    <p>Washigton L Braga Jr</p>
  </li>
  <li>
    <p>Added Spree::Config.auto_capture_on_dispatch that when set to true will
cause shipments to advance to ready state upon successfully authorizing
payment for the order.  As each shipment is marked shipped the
shipment’s total will be captured from the authorization. Fixes #4727</p>

    <p>Jeff Dutil</p>
  </li>
  <li>
    <p>Added <code>actionable?</code> for Spree::Promotion::Rule. <code>actionable?</code> defines
if a promotion action can be applied to a specific line item. This
can be used to customize which line items can accept a promotion
action by defining its logic within the promotion rule rather than
relying on Spree’s default behaviour. Fixes #5036</p>

    <p>Gregor MacDougall</p>
  </li>
  <li>
    <p>Refactored Stock::Coordinator to optionally accept a list of inventory units
for an order so that shipments can be created for an order that do not comprise
only of the order’s line items.</p>

    <p>Andrew Thal</p>
  </li>
  <li>
    <p>Default ship and bill addresses are now saved and restored in callbacks. This
makes the default address functionality available to orders driven through
frontend, backend and API without duplicating the code.</p>

    <p>Magnus von Koeller</p>
  </li>
  <li>
    <p>When a user successfully uses a credit card to pay for an order, that card
becomes the default credit card for that user. On future orders, we automatically
add that default card as a payment when the order reaches the payment step.</p>

    <p>Magnus von Koeller</p>
  </li>
  <li>
    <p>Provided hooks for extensions to seamlessly integrate with the order population workflow.
Extensions make use of the convention of passing parameters during the ‘add to cart’
action https://github.com/spree/spree/blob/master/core/app/models/spree/order_populator.rb#L12
with a prefix like [:options][:voucher_attributes] (in the case of the spree_vouchers
extension).  The extension then provides some methods named according to what was passed in
like:</p>

    <p>https://github.com/spree-contrib/spree_vouchers/blob/master/app/models/spree/order_decorator.rb#L51</p>

    <p>to determine if these possible line item customizations affect the line item equality condition and</p>

    <p>https://github.com/spree-contrib/spree_vouchers/blob/master/app/models/spree/variant_decorator.rb#L3</p>

    <p>to adjust a line item’s price if necessary.</p>

    <p>https://github.com/spree/spree/blob/master/core/app/models/spree/order_contents.rb#L70
shows how we expect inbound parameters (such as the voucher_attributes) to be saved in a
nested_attributes fashion.</p>

    <p>Jeff Squires</p>
  </li>
  <li>
    <p>Rename *_filter callbacks to *_action callbacks.</p>

    <p>Masahiro Saito</p>
  </li>
  <li>
    <p>Move some modules to model’s concerns directory.
We move modules Spree::Core::AdjustmentSource, Spree::Core::CalculatedAdjustments, Spree::Core::UserAddress
and Spree::Core::UserPaymentSource. Fixes #5264.</p>

    <p>Masahiro Saito</p>
  </li>
  <li>
    <p>Enable default html email templates with Zurb Ink, and PreMailer for Rails.</p>

    <p>Ben Morgan &amp; Jeff Dutil</p>
  </li>
</ul>

        </div>
      </div>

    </section>

    <aside id="sidebar" class="four columns">
  <nav id="sidebar-menu">
    <ul>
      <li class='js-topic'>
        <h3>
          <a href="#" class="js-expand-btn collapsed toggle-version-menu"><i class="icon-right-open"></i></a>
          <a href='#.html'>Versions</a>
        </h3>
        <ul class="js-guides">
          <li><i class="icon-dot"></i><a href='spree_3_4_0.html'>3.4.0</a></li>
          <li><i class="icon-dot"></i><a href='spree_3_3_0.html'>3.3.0</a></li>
          <li><i class="icon-dot"></i><a href='spree_3_2_0.html'>3.2.0</a></li>
          <li><i class="icon-dot"></i><a href='spree_3_1_0.html'>3.1.0</a></li>
          <li><i class="icon-dot"></i><a href='spree_3_0_0.html'>3.0.0</a></li>
          <li><i class="icon-dot"></i><a href='spree_2_4_0.html'>2.4.0</a></li>
          <li><i class="icon-dot"></i><a href='spree_2_3_0.html'>2.3.0</a></li>
          <li><i class="icon-dot"></i><a href='spree_2_2_0.html'>2.2.0</a></li>
          <li><i class="icon-dot"></i><a href='spree_2_1_0.html'>2.1.0</a></li>
          <li><i class="icon-dot"></i><a href='spree_2_0_0.html'>2.0.0</a></li>
          <li><i class="icon-dot"></i><a href='spree_1_3_0.html'>1.3.0</a></li>
          <li><i class="icon-dot"></i><a href='spree_1_2_2.html'>1.2.2</a></li>
          <li><i class="icon-dot"></i><a href='spree_1_2_0.html'>1.2.0</a></li>
          <li><i class="icon-dot"></i><a href='spree_1_1_4.html'>1.1.4</a></li>
          <li><i class="icon-dot"></i><a href='spree_1_1_0.html'>1.1.0</a></li>
          <li><i class="icon-dot"></i><a href='spree_1_0_0.html'>1.0.0</a></li>
          <li><i class="icon-dot"></i><a href='spree_0_70_0.html'>0.70.0</a></li>
          <li><i class="icon-dot"></i><a href='spree_0_60_0.html'>0.60.0</a></li>
          <li><i class="icon-dot"></i><a href='spree_0_50_0.html'>0.50.0</a></li>
          <li><i class="icon-dot"></i><a href='spree_0_40_0.html'>0.40.0</a></li>
          <li><i class="icon-dot"></i><a href='spree_0_30_0.html'>0.30.0</a></li>
          <li><i class="icon-dot"></i><a href='spree_0_10_0.html'>0.10.0</a></li>
          <li><i class="icon-dot"></i><a href='spree_0_9_0.html'>0.9.0</a></li>
        </ul>
      </li>
    </ul>
  </nav>
</aside>

  </div>

  <footer id="main-footer">

  <div class="footer-top">
    <div class="container">
      <div id="link-blocks" class="row">
        <div class="link-block six columns">
          <h3 class="block-title">Developers</h3>
          <ul>
            <li><a href="https://slack.spreecommerce.org" target="_blank" rel="nofollow">Slack</a></li>
            <li><a href="https://github.com/spree-contrib" target="_blank">Extensions</a></li>
            <li><a href="https://github.com/spree/spree/blob/master/license.md" target="_blank">License</a></li>
          </ul>
        </div>
        <div class="link-block seven columns">
          <h3 class="block-title">About Spree</h3>
          <p>
            <strong><a href="https://spreecommerce.org">Spree Commerce</a></strong>
            is a complete modular, API-driven open source e-commerce solution
            built with Ruby on Rails.
          </p>
          <p>
            Guides are hosted and maintained by
            <a href="http://sparksolutions.co" target="_blank">Spark Solutions</a>
          </p>
        </div>

      </div>
    </div>
  </div>
</footer>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-104990445-1', 'auto');
  ga('send', 'pageview');
</script>

<script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script>
<script type="text/javascript"> docsearch({
apiKey: 'fb697cd2d04591b036ea172259c05ba8',
indexName: 'spreecommerce',
inputSelector: '#search-field',
debug: false // Set debug to true if you want to inspect the dropdown
});
</script>


  </body>
</html>
